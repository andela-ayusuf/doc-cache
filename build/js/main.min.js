var app=angular.module("dmsApp",["ui.router","ngStorage","ngMaterial","ngAria","ngResource","ngMdIcons"]);app.config(["$stateProvider","$urlRouterProvider","$httpProvider","$locationProvider",function(e,t,o,n){e.state("home",{url:"/",templateUrl:"app/views/home.view.html",controller:"HomeCtrl"}).state("login",{url:"/login",templateUrl:"app/views/login.view.html",controller:"UserCtrl"}).state("signup",{url:"/signup",templateUrl:"app/views/signup.view.html",controller:"UserCtrl"}).state("dashboard",{url:"/dashboard",templateUrl:"app/views/dashboard.view.html",controller:"DashboardCtrl"}).state("document",{url:"/document",templateUrl:"app/views/document.view.html",controller:"DocumentCtrl"}).state("profile",{url:"/profile",templateUrl:"app/views/profile.view.html",controller:"UserCtrl"}),t.otherwise("/"),o.interceptors.push(["$q","$location","$window",function(e,t,o){return{request:function(e){return e.headers=e.headers||{},o.sessionStorage.token&&(e.headers["x-access-token"]=o.sessionStorage.token),e},responseError:function(o){return 403===o.status&&t.url("/home"),e.reject(o)}}}])}]),angular.module("dmsApp").controller("DashboardCtrl",["$scope","$timeout",function(e,t){var o=this;o.isOpen=!1,e.$watch("demo.isOpen",function(n){n?t(function(){e.tooltipVisible=o.isOpen},600):e.tooltipVisible=o.isOpen}),o.items=[{name:"Profile",icon:"../assets/imgs/account.svg",href:"/#/profile"}]}]),angular.module("dmsApp").controller("DocumentCtrl",["DocumentService","ToastService","$window","$scope","$mdDialog","$location","$localStorage",function(e,t,o,n,r,s,a){function i(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()}}n.createDoc=function(){e.createDoc(n.docs).then(function(e){location.reload(),t.showSimpleToast(e.data.message)},function(e){t.showSimpleToast("Please Fill The Required Fields!")})},n.getUserDocs=function(){var t=o.sessionStorage.userId;e.getUserDocs(t).then(function(e){n.userDocs=e.data},function(e){})},n.getDocId=function(){var e=o.sessionStorage.docId;return e},n.getDoc=function(t){o.sessionStorage.docId=t,e.getDoc(t).then(function(e){s.url("/document"),n.docs=e.data},function(e){})},n.editDoc=function(n){var r=o.sessionStorage.docId;e.editDoc(r,n).then(function(e){location.reload(),s.url("/document"),t.showSimpleToast(e.data.message)},function(e){t.showSimpleToast("Please Fill The Required Fields!")})},n.editDocEv=function(e){r.show({controller:i,templateUrl:"app/views/editDoc.view.html",parent:angular.element(document.body),targetEvent:e})},n.deleteDocEv=function(e){r.show({controller:i,templateUrl:"app/views/deleteDoc.view.html",parent:angular.element(document.body),targetEvent:e})},n.deleteDoc=function(n){n=o.sessionStorage.docId,e.deleteDoc(n).then(function(e){location.reload(),s.url("/dashboard"),t.showSimpleToast(e.data.message)},function(e){})}}]),angular.module("dmsApp").controller("HomeCtrl",["$scope","$timeout",function(e,t){var o=this;o.isOpen=!1,e.$watch("demo.isOpen",function(n){n?t(function(){e.tooltipVisible=o.isOpen},600):e.tooltipVisible=o.isOpen}),o.items=[{name:"Signup",icon:"../assets/imgs/account-plus.svg",href:"/#/signup"},{name:"Login",icon:"../assets/imgs/login.svg",href:"/#/login"}]}]),angular.module("dmsApp").controller("UserCtrl",["$scope","$rootScope","UserService","ToastService","$location","$resource","$mdDialog","$window","$http",function(e,t,o,n,r,s,a,i,u){function l(e,t){e.hide=function(){t.hide()},e.cancel=function(){t.cancel()}}e.saveSessStorage=function(e,t){i.sessionStorage.token=t,i.sessionStorage.userId=e},e.signup=function(){o.createUser(e.user).then(function(t){e.saveSessStorage(t.data.id,t.data.token),e.userId=t.data.id,r.url("/dashboard"),n.showSimpleToast(t.data.message)},function(e){"User validation failed"===e.data.message?n.showSimpleToast("Password must be Five characters or more!"):n.showSimpleToast(e.data.message)})},e.login=function(){o.login(e.user).then(function(t){e.saveSessStorage(t.data.id,t.data.token),r.url("/dashboard"),n.showSimpleToast(t.data.message)},function(e){n.showSimpleToast(e.data.message)})},e.logout=function(){i.sessionStorage.clear(),r.url("/home")},e.getUser=function(){var t=i.sessionStorage.userId;o.getUser(t).then(function(t){e.users=t.data},function(e){n.showSimpleToast(e.data.message)})},e.getUserId=function(){var e=i.sessionStorage.userId;return e},e.editUser=function(t){var r=i.sessionStorage.userId;o.editUser(r,t).then(function(t){e.user=t,location.reload(),n.showSimpleToast(t.data.message)},function(e){n.showSimpleToast(e.data.message)})},e.editUserEv=function(e){a.show({controller:l,templateUrl:"app/views/editProfile.view.html",parent:angular.element(document.body),targetEvent:e})},e.deleteUserEv=function(e){a.show({controller:l,templateUrl:"app/views/deleteProfile.view.html",parent:angular.element(document.body),targetEvent:e})},e.deleteUser=function(){var e=i.sessionStorage.userId;o.deleteUser(e).then(function(e){i.sessionStorage.clear(),r.url("/home")},function(e){n.showSimpleToast(e.data.message)})}}]),angular.module("dmsApp").value("baseUrl","http://localhost:5000"),angular.module("dmsApp").factory("DocumentService",["$http","baseUrl",function(e,t){var o={};return o.createDoc=function(o){return e.post(t+"/api/documents",o).then(function(e){return e})},o.getUserDocs=function(o){return e.get(t+"/api/users/"+o+"/documents").then(function(e){return e})},o.getDoc=function(o){return e.get(t+"/api/documents/"+o).then(function(e){return e})},o.editDoc=function(o,n){return e.put(t+"/api/documents/"+o,n).then(function(e){return e})},o.deleteDoc=function(o){return e["delete"](t+"/api/documents/"+o).then(function(e){return e})},o}]),angular.module("dmsApp").factory("ToastService",["$mdToast",function(e){var t={};return t.showSimpleToast=function(t){e.show(e.simple().content(t).position("right").hideDelay(3e3))},t}]),angular.module("dmsApp").factory("UserService",["$http","baseUrl",function(e,t){var o={};return o.createUser=function(o){return e.post(t+"/api/users",o).then(function(e){return e})},o.login=function(o){return e.post(t+"/api/users/login",o).then(function(e){return e})},o.getUser=function(o){return e.get(t+"/api/users/"+o).then(function(e){return e})},o.editUser=function(o,n){return e.put(t+"/api/users/"+o,n).then(function(e){return e})},o.deleteUser=function(o){return e["delete"](t+"/api/users/"+o).then(function(e){return e})},o}]);